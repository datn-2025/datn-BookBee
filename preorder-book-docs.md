
# ğŸ“˜ TÃ€I LIá»†U CHá»¨C NÄ‚NG: Äáº¶T TRÆ¯á»šC SÃCH (PRE-ORDER BOOK)

## ğŸ”¹ 1. Má»¤C TIÃŠU
Cho phÃ©p ngÆ°á»i dÃ¹ng **Ä‘áº·t trÆ°á»›c** cÃ¡c cuá»‘n sÃ¡ch sáº¯p ra máº¯t (ebook hoáº·c sÃ¡ch váº­t lÃ½), vá»›i lá»±a chá»n thuá»™c tÃ­nh, Ä‘á»‹a chá»‰ nháº­n hÃ ng (náº¿u lÃ  sÃ¡ch váº­t lÃ½), vÃ  thanh toÃ¡n trÆ°á»›c hoáº·c giá»¯ Ä‘Æ¡n.

## ğŸ”¹ 2. PHÃ‚N LOáº I SÃCH
- **SÃ¡ch Ä‘iá»‡n tá»­ (Ebook)**:
  - KhÃ´ng cáº§n Ä‘á»‹a chá»‰ nháº­n hÃ ng.
  - Sau ngÃ y ra máº¯t, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ táº£i vá».

- **SÃ¡ch váº­t lÃ½ (Physical Book)**:
  - Cáº§n chá»n Ä‘á»‹a chá»‰ nháº­n hÃ ng.
  - Sau ngÃ y ra máº¯t sáº½ tiáº¿n hÃ nh giao hÃ ng.

## ğŸ”¹ 3. CHá»¨C NÄ‚NG CLIENT (NGÆ¯á»œI DÃ™NG)

### 3.1. Hiá»ƒn thá»‹ danh sÃ¡ch sÃ¡ch Ä‘áº·t trÆ°á»›c trÃªn trang chá»§
- Vá»‹ trÃ­: **Trang chá»§** hoáº·c **trang danh má»¥c sÃ¡ch**.
- SÃ¡ch Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u báº±ng **label "Äáº·t trÆ°á»›c"** (vÃ­ dá»¥: ğŸ”– *Sáº¯p ra máº¯t*).
- Chá»‰ hiá»ƒn thá»‹ cÃ¡c sÃ¡ch cÃ³ `release_date > hiá»‡n táº¡i`.

### 3.2. Modal Form khi click "Äáº·t trÆ°á»›c"
Khi ngÆ°á»i dÃ¹ng nháº¥n **nÃºt â€œÄáº·t trÆ°á»›câ€**, hiá»ƒn thá»‹ **modal** vá»›i form gá»“m:

- **TÃªn sÃ¡ch**
- **Chá»n thuá»™c tÃ­nh** (náº¿u cÃ³): vÃ­ dá»¥: bÃ¬a má»m/bÃ¬a cá»©ng, Ä‘á»‹nh dáº¡ng PDF/ePub,...
- **Sá»‘ lÆ°á»£ng**
- **Chá»n Ä‘á»‹a chá»‰ nháº­n hÃ ng** *(chá»‰ hiá»ƒn thá»‹ náº¿u lÃ  sÃ¡ch váº­t lÃ½)*:
  - Sá»­ dá»¥ng Ä‘á»‹a chá»‰ cÃ³ sáºµn hoáº·c thÃªm má»›i.
- **Chá»n phÆ°Æ¡ng thá»©c thanh toÃ¡n**:
  - Thanh toÃ¡n online

> âœ… Khi submit, há»‡ thá»‘ng ghi nháº­n Ä‘Æ¡n Ä‘áº·t trÆ°á»›c vÃ  gá»­i email xÃ¡c nháº­n cho ngÆ°á»i dÃ¹ng.

## ğŸ”¹ 4. CHá»¨C NÄ‚NG ADMIN (QUáº¢N TRá»Š VIÃŠN)

### 4.1. ThÃªm má»›i sÃ¡ch (Form thÃªm sÃ¡ch)
- CÃ³ trÆ°á»ng `NgÃ y ra máº¯t (release_date)` â€“ báº¯t buá»™c.
- CÃ³ tÃ¹y chá»n: **Cho phÃ©p Ä‘áº·t trÆ°á»›c** âœ…
- Chá»n loáº¡i sÃ¡ch: `ebook`, `váº­t lÃ½`, hoáº·c `cáº£ hai`.
- Náº¿u lÃ  sÃ¡ch váº­t lÃ½ â†’ cÃ³ thá»ƒ cáº¥u hÃ¬nh thuá»™c tÃ­nh nhÆ° loáº¡i bÃ¬a, phiÃªn báº£n Ä‘áº·c biá»‡t,...
- Cho phÃ©p nháº­p giÃ¡ Æ°u Ä‘Ã£i(náº¿u cÃ³)

### 4.2. Quáº£n lÃ½ Ä‘Æ¡n Ä‘áº·t trÆ°á»›c
Trang: `/admin/preorders`  
ThÃ´ng tin hiá»ƒn thá»‹:

| MÃ£ Ä‘Æ¡n | TÃªn khÃ¡ch hÃ ng | TÃªn sÃ¡ch | Loáº¡i | Tráº¡ng thÃ¡i | NgÃ y Ä‘áº·t | NgÃ y ra máº¯t |
|--------|----------------|----------|------|------------|----------|-------------|

- Tráº¡ng thÃ¡i: Chá» xá»­ lÃ½, ÄÃ£ thanh toÃ¡n, ÄÃ£ giao, Háº¿t hÃ ng,...
- CÃ³ nÃºt Ä‘á»ƒ chuyá»ƒn Ä‘Æ¡n sang **Ä‘Æ¡n hÃ ng chÃ­nh thá»©c** sau khi sÃ¡ch phÃ¡t hÃ nh.

### 4.3. Tá»± Ä‘á»™ng cáº­p nháº­t tráº¡ng thÃ¡i
- VÃ o **ngÃ y ra máº¯t**, há»‡ thá»‘ng sáº½:
  - KÃ­ch hoáº¡t viá»‡c gá»­i sÃ¡ch Ä‘iá»‡n tá»­ cho ngÆ°á»i Ä‘Ã£ Ä‘áº·t.
  - Chuyá»ƒn cÃ¡c Ä‘Æ¡n sÃ¡ch váº­t lÃ½ sang tráº¡ng thÃ¡i "Chá» giao hÃ ng".
  - Gá»­i email thÃ´ng bÃ¡o cho ngÆ°á»i dÃ¹ng.

## ğŸ”¹ 5. CÆ  Sá» Dá»® LIá»†U Gá»¢I Ã

### Báº£ng `books`
```sql
id | title | type | release_date | allow_preorder | ...
```

### Báº£ng `preorders`
```sql
id | user_id | book_id | quantity | attributes | address_id | payment_method | status | created_at
```

### Báº£ng `addresses`
```sql
id | user_id | receiver_name | phone | address_line
```

## ğŸ”¹ 6. LUá»’NG CHáº Y (FLOW)

```mermaid
flowchart TD
  A[Trang chá»§ hiá»ƒn thá»‹ sÃ¡ch Ä‘áº·t trÆ°á»›c]
  B[NgÆ°á»i dÃ¹ng nháº¥n "Äáº·t trÆ°á»›c"]
  C[Hiá»‡n Modal form]
  D[NgÆ°á»i dÃ¹ng chá»n thuá»™c tÃ­nh + Ä‘á»‹a chá»‰ + thanh toÃ¡n]
  E[Gá»­i Ä‘Æ¡n Ä‘áº·t trÆ°á»›c]
  F[Há»‡ thá»‘ng lÆ°u Ä‘Æ¡n vÃ  gá»­i email]
  G[Chá» tá»›i ngÃ y ra máº¯t]
  H[Ra máº¯t: Giao sÃ¡ch hoáº·c kÃ­ch hoáº¡t ebook]

  A --> B --> C --> D --> E --> F --> G --> H
```

## ğŸ”¹ 7. Gá»¢I Ã GIAO DIá»†N (FRONTEND)

### 7.1. Trang chá»§ hiá»ƒn thá»‹ sÃ¡ch Ä‘áº·t trÆ°á»›c

```html
<div class="book-card">
  <span class="label label-warning">Äáº·t trÆ°á»›c</span>
  <h3>TÃªn sÃ¡ch</h3>
  <p>NgÃ y ra máº¯t: 20/08/2025</p>
  <button class="btn btn-primary" data-toggle="modal" data-target="#preorderModal">Äáº·t trÆ°á»›c</button>
</div>
```

### 7.2. Modal form Ä‘áº·t trÆ°á»›c

```html
<form id="preorder-form">
  <label>Thuá»™c tÃ­nh:</label>
  <select name="variant">...</select>

  <label>Sá»‘ lÆ°á»£ng:</label>
  <input type="number" name="quantity" />

  <div id="address-section">
    <label>Äá»‹a chá»‰ nháº­n hÃ ng:</label>
    <select name="address_id">...</select>
  </div>

  <label>PhÆ°Æ¡ng thá»©c thanh toÃ¡n:</label>
  <select name="payment_method">
    <option value="online">Thanh toÃ¡n online</option>
    <option value="cod">COD</option>
  </select>

  <button type="submit">XÃ¡c nháº­n Ä‘áº·t trÆ°á»›c</button>
</form>
```

## ğŸ”¹ 8. Gá»¢I Ã Xá»¬ LÃ BACKEND

- Kiá»ƒm tra `release_date` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh sÃ¡ch cÃ²n cho Ä‘áº·t trÆ°á»›c hay khÃ´ng.
- Náº¿u `type == physical`, báº¯t buá»™c cÃ³ Ä‘á»‹a chá»‰.
- gá»­i hÃ³a Ä‘Æ¡n sau khi thanh toÃ¡n
- Gá»­i mail sau khi Ä‘áº·t thÃ nh cÃ´ng.
- gá»­i mail sau khi sÃ¡ch ra máº¯t vÃ  táº¡o Ä‘Æ¡n hÃ ng
