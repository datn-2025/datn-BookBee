a. Điều kiện tiên quyết
Người dùng đã đăng nhập và có ví nội bộ đã kích hoạt.

Đơn hàng ở trạng thái Chờ thanh toán.

Số dư ví ≥ Tổng tiền đơn hàng (bao gồm phí vận chuyển nếu có).

b. Quy trình thanh toán
Khởi tạo giao dịch:

Người dùng chọn "Ví điện tử" tại trang thanh toán.

Hệ thống kiểm tra:

Sự tồn tại của ví

Số dư khả dụng

Trạng thái ví 

Thực hiện trừ tiền:

Trừ chính xác tổng đơn hàng từ ví.

Ghi nhận giao dịch vào đb 

Cập nhật đơn hàng:

Chuyển trạng thái đơn hàng → Đã thanh toán.

tạo hóa đơn thanh toán

Ghi nhận phương thức: Ví điện tử.

Hoàn tất:

Gửi thông báo:

Email xác nhận đơn hàng.

Email hóa đơn thanh toán

Cập nhật số dư mới của ví.

hiển thị giao dịch trong mục "Lịch sử giao dịch" của ví.

